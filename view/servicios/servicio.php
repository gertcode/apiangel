
            <div class="content-wrapper">
                <section class="content-header">
                    <div class="header-icon">
                        <i class="ti-truck"></i>
                    </div>
                    <div class="header-title">
                        <h1>Nuevo Servicio</h1>
                        <small>Espacio para crear y asociar un nuevo servicio al cliente.</small>
                    </div>
                </section>
                <!-- Main content -->
                <section class="content">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="panel panel-bd">
                                <div class="panel-heading">
                                    <div class="panel-title">
                                        <h4>Asistente para dar de alta servicios.</h4>
                                    </div>
                                </div>
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-sm-12 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3 text-center">
                                            <form method="post" class="f1">
                                                <h3 class="m-t-0">Registro de Servicio</h3>

                                                <div class="f1-steps">
                                                    <div class="f1-progress">
                                                        <div class="f1-progress-line" data-now-value="16.66" data-number-of-steps="3" style="width: 10%;"></div>
                                                    </div>
                                                    <div class="f1-step active">
                                                        <div class="f1-step-icon"><i class="fa fa-user"></i></div>
                                                        <p>Origen / Destino</p>
                                                    </div>
                                                    <div class="f1-step">
                                                        <div class="f1-step-icon"><i class="fa ti-truck"></i></div>
                                                        <p>Transporte</p>
                                                    </div>
                                                    <div class="f1-step">
                                                        <div class="f1-step-icon"><i class="fa fa-user"></i></div>
                                                        <p>Cliente</p>
                                                    </div>
                                                </div>
                                                <fieldset>
                                                    <h4 class="m-t-0">Origen:</h4>
                                                    <div class="form-group">
                                                        <select id="origen" name="origen">
                                                            <option value='0'>Seleccione el Origen</option>
                                                            <option value='AGU'>Aguascalientes</option>
                                                            <option value='BCN'>Baja California</option>
                                                            <option value='BCS'>Baja California Sur</option>
                                                            <option value='CAM'>Campeche</option>
                                                            <option value='CHP'>Chiapas</option>
                                                            <option value='CHH'>Chihuahua</option>
                                                            <option value='COA'>Coahuila</option>
                                                            <option value='COL'>Colima</option>
                                                            <option value='DIF'>Distrito Federal</option>
                                                            <option value='CMX'>Ciudad de México</option>
                                                            <option value='DUR'>Durango</option>
                                                            <option value='GUA'>Guanajuato</option>
                                                            <option value='GRO'>Guerrero</option>
                                                            <option value='HID'>Hidalgo</option>
                                                            <option value='JAL'>Jalisco</option>
                                                            <option value='MEX'>Estado de México</option>
                                                            <option value='MIC'>Michoacán</option>
                                                            <option value='MOR'>Morelos</option>
                                                            <option value='NAY'>Nayarit</option>
                                                            <option value='NLE'>Nuevo León</option>
                                                            <option value='OAX'>Oaxaca</option>
                                                            <option value='PUE'>Puebla</option>
                                                            <option value='QUE'>Querétaro</option>
                                                            <option value='ROO'>Quintana Roo</option>
                                                            <option value='SLP'>San Luis Potosí</option>
                                                            <option value='SIN'>Sinaloa</option>
                                                            <option value='SON'>Sonora</option>
                                                            <option value='TAB'>Tabasco</option>
                                                            <option value='TAM'>Tamaulipas</option>
                                                            <option value='TLA'>Tlaxcala</option>
                                                            <option value='VER'>Veracruz</option>
                                                            <option value='YUC'>Yucatán</option>
                                                            <option value='ZAC'>Zacatecas</option>
                                                            <option value='CR'>Costa Rica</option>
                                                            <option value='GT'>Guatemala</option>
                                                            <option value='NI'>Nicaragua</option>
                                                            <option value='SV'>El salvador</option>
                                                            <option value='PA'>Panamá</option>
                                                        </select>
                                                    </div>
                                                    <h4 class="m-t-0">Destino:</h4>
                                                    <div class="form-group">
                                                        <select id="destino" name="destino">
                                                            <option value='0'>Seleccione el Destino</option>
                                                            <option value='AGU'>Aguascalientes</option>
                                                            <option value='BCN'>Baja California</option>
                                                            <option value='BCS'>Baja California Sur</option>
                                                            <option value='CAM'>Campeche</option>
                                                            <option value='CHP'>Chiapas</option>
                                                            <option value='CHH'>Chihuahua</option>
                                                            <option value='COA'>Coahuila</option>
                                                            <option value='COL'>Colima</option>
                                                            <option value='DIF'>Distrito Federal</option>
                                                            <option value='CMX'>Ciudad de México</option>
                                                            <option value='DUR'>Durango</option>
                                                            <option value='GUA'>Guanajuato</option>
                                                            <option value='GRO'>Guerrero</option>
                                                            <option value='HID'>Hidalgo</option>
                                                            <option value='JAL'>Jalisco</option>
                                                            <option value='MEX'>Estado de México</option>
                                                            <option value='MIC'>Michoacán</option>
                                                            <option value='MOR'>Morelos</option>
                                                            <option value='NAY'>Nayarit</option>
                                                            <option value='NLE'>Nuevo León</option>
                                                            <option value='OAX'>Oaxaca</option>
                                                            <option value='PUE'>Puebla</option>
                                                            <option value='QUE'>Querétaro</option>
                                                            <option value='ROO'>Quintana Roo</option>
                                                            <option value='SLP'>San Luis Potosí</option>
                                                            <option value='SIN'>Sinaloa</option>
                                                            <option value='SON'>Sonora</option>
                                                            <option value='TAB'>Tabasco</option>
                                                            <option value='TAM'>Tamaulipas</option>
                                                            <option value='TLA'>Tlaxcala</option>
                                                            <option value='VER'>Veracruz</option>
                                                            <option value='YUC'>Yucatán</option>
                                                            <option value='ZAC'>Zacatecas</option>
                                                            <option value='CR'>Costa Rica</option>
                                                            <option value='GT'>Guatemala</option>
                                                            <option value='NI'>Nicaragua</option>
                                                            <option value='SV'>El salvador</option>
                                                            <option value='PA'>Panamá</option>
                                                        </select>
                                                    </div>
                                                    <div class="f1-buttons">
                                                        <button type="button" class="btn btn-success btn-next">Siguiente</button>
                                                    </div>
                                                </fieldset>
                                                <fieldset>
                                                  <h4 class="m-t-0">Tipo de Unidad:</h4>
                                                  <div class="form-group">
                                                      <select id="tipounidad" name="tipounidad">
                                                          <option value='0'>Seleccione el tipo de Unidad</option>
                                                          <option value='A'>20'</option>
                                                          <option value='B'>40'</option>
                                                          <option value='C'>48'</option>
                                                          <option value='D'>53'</option>
                                                          <option value='E'>Plataforma</option>
                                                          <option value='F'>1 Ton</option>
                                                          <option value='G'>3 1/2</option>
                                                          <option value='H'>Torton</option>
                                                          <option value='I'>Portacontenedor</option>
                                                          <option value='J'>Rabón</option>
                                                      </select>
                                                  </div>
                                                    <h4 class="m-t-0">Medio de Transporte:</h4>
                                                    <div class="form-group">
                                                        <select id="tipomediotransporte" name="tipomediotransporte" onchange="seleccionarTipoModalidad()">
                                                            <option value='0'>Seleccione el medio de transporte</option>
                                                            <option value='T'>Terrestre</option>
                                                            <option value='A'>Aéreo</option>
                                                            <option value='M'>Marítimo</option>
                                                            <option value='I'>Intermodal</option>
                                                        </select>
                                                    </div>
                                                    <h4 class="m-t-0">Tipo de Servicio:</h4>
                                                    <div class="form-group">
                                                        <select id="tiposervicio" name="tiposervicio">
                                                            <option value='0'>Seleccione el medio tipo de servicio</option>
                                                            <option value='I'>Importación</option>
                                                            <option value='E'>Exportación</option>
                                                            <option value='L'>Local</option>
                                                            <option value='N'>Nacional</option>
                                                        </select>
                                                    </div>
                                                    <h4 class="m-t-0">Modalidad:</h4>
                                                    <div class="form-group">
                                                        <select id="tipoModalidad" name="tipoModalidad">

                                                        </select>
                                                    </div>
                                                    <h4 class="m-t-0">Tipo de carga:</h4>
                                                    <div class="form-group">
                                                        <select id="tipocarga" name="tipocarga">
                                                            <option value='R'>Refrigerado</option>
                                                            <option value='P'>Peligroso</option>
                                                            <option value='G'>General</option>
                                                            <option value='S'>Sobre dimensionado</option>
                                                        </select>
                                                    </div>
                                                    <div class="f1-buttons">
                                                        <button type="button" class="btn btn-previous">Anterior</button>
                                                        <button type="button" class="btn btn-success btn-next">Siguiente</button>
                                                    </div>
                                                </fieldset>
                                                <fieldset>
                                                    <h4>Asociando al cliente:</h4>
                                                  <!--  <div class="form-group">
                                                        <label class="sr-only" for="f1-facebook">Buscar Cliente</label>
                                                        <input type="text" name="f1-facebook" placeholder="Escribe algún fragmento del cliente si no se encuentra en lista." class="form-control" id="f1-facebook">
                                                        <button onclick="getDataClient()" type="button" class="btn btn-success">Buscar</button>
                                                    </div>-->
                                                    <div class="form-group">
                                                        <label class="sr-only" for="f1-facebook">Clientes Frecuentes:</label>
                                                        <select id="clienteLista" name="clienteLista">
                                                        <option value='0'>       -- Lista de Clientes --        </option>
                                                            <?php foreach($this->model->ListarClientes() as $r): ?>
                                                              <option value='<?php echo $r->id_cliente; ?>'><?php echo $r->remitente; ?></option>
                                                            <?php endforeach; ?>
                                                        </select>

                                                    </div>
                                                    <div class="f1-buttons">
                                                        <button type="button" class="btn btn-previous">Anterior</button>
                                                        <button type="button" class="btn btn-success btn-submit" onclick="generarGuia()">Generar Guía</button>
                                                    </div>
                                                </fieldset>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section> <!-- /.content -->
            </div>
            <footer class="main-footer">
                <div class="pull-right hidden-xs"> <b>Version</b> 1.0</div>
                <strong>Sistema de Gestión de Servicios para: <a href="http://www.vimexi.com/">Vimexi SA de CV</a>.</strong>
            </footer>
        </div> <!-- ./wrapper -->

        <?php //print_r ($this->model->ListarClientes()); ?>




<script type="text/javascript">
    function seleccionarTipoModalidad()
    {
        //alert("OK");
        var tip = $("#tipomediotransporte").val();
        //alert(tip);
        if (tip=="T") {
            $("#tipoModalidad").html("");
            $("#tipoModalidad").append("<option value='F-Completo FTL'>Completo FTL</option>");
            $("#tipoModalidad").append("<option value='L-Consolidado LTL'>Consolidado LTL</option>");
        }
        else if (tip=="A") {
            $("#tipoModalidad").html("");
            $("#tipoModalidad").append("<option value='L-Consolidado LCL'>Consolidado LCL</option>");
        }

        else if (tip=="M") {
            $("#tipoModalidad").html("");
            $("#tipoModalidad").append("<option value='F-Completo FCL'>Completo FCL</option>");
            $("#tipoModalidad").append("<option value='L-Consolidado LCL'>Consolidado LCL</option>");
        }
        else if (tip=="I") {
            $("#tipoModalidad").html("");
            $("#tipoModalidad").append("<option value='F-Completo FTL'>Completo FTL</option>");
            $("#tipoModalidad").append("<option value='L-Consolidado LTL'>Consolidado LTL</option>");
            $("#tipoModalidad").append("<option value='F-Completo FCL'>Completo FCL</option>");
            $("#tipoModalidad").append("<option value='L-Consolidado LCL'>Consolidado LCL</option>");
        }

    }

    function getDataClient()
    {
        $.get("index.php?c=Servicio&a=ObtenerClientesBusqueda&data=1",function(data){
          //alert(data);
        });
    }

    function generarGuia()
    {
        var origen = $("#origen").val();
        var destino = $("#destino").val();
        var tipounidad = $("#tipounidad").val();
        var tipomediotransporte = $("#tipomediotransporte").val();
        var tiposervicio = $("#tiposervicio").val();
        var tipoModalidad = $("#tipoModalidad").val();
        var tipocarga = $("#tipocarga").val();//clienteLista
        var clienteLista = $("#clienteLista").val();
        //var id_cliente = $("#id_cliente").val();
        var tipoModa = tipoModalidad.split('-');
        //alert(tipoModa[0]+" "+tipoModa[1]);
        toastr.options = {
            "debug": false,
            "newestOnTop": false,
            "positionClass": "toast-top-center",
            "closeButton": true,
            "toastClass": "animated fadeInDown"
        };

        if (origen!="0") {
          if (destino!="0") {
            if (tipounidad!="0") {
              if (tipomediotransporte!="0") {
                if (tiposervicio!="0") {
                  if (tipoModalidad!="0") {
                    if (tipocarga!="0") {
                      if(clienteLista!="0")
                        {
                          $.get("index.php?c=Servicio&a=obtenerUltimaGuia",function(data){
                            //alert(origen+"-"+destino+"/"+tipounidad+"/"+tipomediotransporte+tiposervicio+tipoModalidad+tipocarga+data);
                            //alert(data);
                                //toastr.info('Info - This is a custom Homer info notification');
                                var num = data.split('-');
                                swal({
                                    title: "Deseas generar la siguiente Guía?",
                                    text: origen+"-"+destino+"/"+tipounidad+"/"+tipomediotransporte+tiposervicio+tipoModa[0]+tipocarga+data,
                                    type: "warning",
                                    showCancelButton: true,
                                    confirmButtonColor: "#DD6B55",
                                    confirmButtonText: "Guardar",
                                    cancelButtonText: "Editar",
                                    closeOnConfirm: false,
                                    closeOnCancel: true},
                                        function (isConfirm) {
                                            if (isConfirm) {

                                              //alert("OK");

                                                $.get("index.php?c=Servicio&a=insertarGuia",{origen:origen,destino:destino,tipounidad:tipounidad,tipomediotransporte:tipomediotransporte,tiposervicio:tiposervicio,tipoModalidad:tipoModa[0],tipocarga:tipocarga,numeroservicio:num[0],anio:"17",guiafull:origen+"-"+destino+"/"+tipounidad+"/"+tipomediotransporte+tiposervicio+tipoModa[0]+tipocarga+data,clienteLista:clienteLista,tipoModalidadtexto:tipoModa[1]},function(data){

                                                  //alert(data);
                                                  if(data=="okguia")
                                                  {
                                                    //swal("Guía Generada!", "La guía se generó con éxito", "success");
                                                    swal({
                                                        title: "Guía Generada!",
                                                        text: "La guía se generó con éxito",
                                                        type: "success",
                                                        showCancelButton: false,
                                                        confirmButtonText: "OK",
                                                        cancelButtonText: "Editar",
                                                        closeOnConfirm: false,
                                                        closeOnCancel: true},
                                                            function (isConfirm) {
                                                                if (isConfirm) {
                                                                    window.location.replace("index.php?c=Servicio&a=Consulta");
                                                                }
                                                            });
                                                  }
                                                  else {
                                                    alert(data);
                                                  }

                                                });

                                                //alert("Generada");
                                            } else {
                                            //swal("Cancelado", "Acción cancelada", "error");
                                            }
                                        });

                          });
                        }
                        else {
                          //alert("Falta cliente");
                          toastr.error('No se ha seleccionado un cliente');
                        }
                      }
                    else {
                      //alert("Selecciona un tipo de carga");
                      toastr.error('No se ha seleccionado un tipo de Carga');
                    }
                  }
                  else {
                    //alert("Selecciona un tipo de modalidad");
                    toastr.error('No se ha seleccionado un tipo de Modalidad');
                  }
                }
                else {
                  //alert("Selecciona un tipo de servicio");
                  toastr.error('No se ha seleccionado un tipo de Servicio');
                }
              }
              else {
                //alert("Selecciona un medio de transporte");
                toastr.error('No se ha seleccionado un Medio de Transporte');
              }
            }
            else {
              //alert("Seleccione unidad");
              toastr.error('No se ha seleccionado un tipo de Unidad');
            }
          }
          else {
            //alert("Selecciona un destino");
            toastr.error('No se ha seleccionado un Destino');
          }
        }
        else {
          //alert("Selecciona un origen");
          toastr.error('No se ha seleccionado un Origen');
        }


    }
</script>
